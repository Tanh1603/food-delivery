config:
  target: "{{ $processEnvironment.TARGET_URL }}"
  phases:
    # Sustained load for 30 minutes
    - duration: 1800  # 30 minutes
      arrivalRate: 100
      name: "Sustained 100 users/sec for 30 minutes"

  processor: "./processor.js"

scenarios:
  - name: "Mixed Traffic"
    flow:
      - get:
          url: "/api/restaurants"
      - think: 2
      - get:
          url: "/api/restaurants/{{ $randomNumber(1, 20) }}/menu"
      - think: 3
      - post:
          url: "/api/orders"
          json:
            restaurant_id: "{{ $randomNumber(1, 20) }}"
            user_email: "user{{ $randomNumber(1, 5000) }}@test.com"
            items:
              - menu_item_id: "{{ $randomNumber(1, 50) }}"
                quantity: 1
